{% extends 'fenxi/base.html' %}
{% block title %}分析模块{% endblock %}
{% block content %}


<section class="wrapper" style="padding: 20px; background-color: #fafafa;">
    <div class="row">
        <div class="col-lg-12">
            <!-- 页面标题优化：增加间距和阴影，提升层次感 -->
            <h3 class="page-header" style="margin: 0 0 20px; padding-bottom: 10px; border-bottom: 1px solid #eee; box-shadow: 0 2px 3px rgba(0,0,0,0.05);">
                <i class="icon_piechart" style="color: #3498db;"></i> 分析
            </h3>
            <!-- 面包屑样式优化：调整字体和间距 -->
            <ol class="breadcrumb" style="margin-bottom: 25px; padding: 10px 15px; background-color: #fff; border-radius: 4px; box-shadow: 0 1px 2px rgba(0,0,0,0.05);">
                <li><i class="fa fa-home" style="color: #3498db;"></i><a href="/index" style="color: #3498db;">Home</a></li>
                <li><i class="icon_piechart" style="color: #666;"></i>分析</li>
            </ol>
        </div>
    </div>

    <div class="row">
        <!-- chart morris start -->
        <div class="col-lg-12">
            <!-- 面板样式优化：白色背景+阴影，增加内边距 -->
            <section class="panel" style="background-color: #fff; border: none; box-shadow: 0 2px 8px rgba(0,0,0,0.08); border-radius: 6px; overflow: hidden;">
                <!-- 城市选择下拉框：增加提示词+美化样式 -->
                <div style="padding: 20px 25px; border-bottom: 1px solid #f0f0f0;">
                    <!-- 提示词：加粗+固定间距 -->
                    <label style="font-weight: 600; color: #333; margin-right: 10px;">城市选择：</label>
                    <!-- 下拉框：美化样式+选中跳转 -->
                    <select
                        onchange="if(this.value) window.location.href='/fenxi?city=' + this.value"
                        style="padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px; color: #333; min-width: 200px; transition: border-color 0.3s ease;"
                    >
                        <!-- 默认提示选项 -->
                        <option value="">请选择城市</option>
                        <!-- 循环生成城市选项 -->
                        {% for city1 in citys %}
                            <option value="{{ city1 }}">{{ city1 }}</option>
                        {% endfor %}
                    </select>
                </div>

                <!-- 图表区域：增加内边距，避免紧贴边框 -->
                <div class="panel-body" style="padding: 25px;">
                    <div class="tab-pane" id="chartjs">
                        <!-- 折线图面板：增加阴影 -->
                        <div class="row mb-4">
                            <div class="col-lg-12">
                                <section class="panel" style="border: none; box-shadow: 0 1px 5px rgba(0,0,0,0.05); border-radius: 4px;">

                                    <div class="panel-body" id="app1" style="height: 335px; width: 100%; padding: 10px 0;"></div>
                                </section>
                            </div>
                        </div>

                        <!-- 柱状图面板：增加阴影 -->
                        <div class="row">
                            <div class="col-lg-12">
                                <section class="panel" style="border: none; box-shadow: 0 1px 5px rgba(0,0,0,0.05); border-radius: 4px;">

                                    <div class="panel-body" id="app2" style="height: 335px; width: 100%; padding: 10px 0;"></div>
                                </section>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </div>
</section>




{% endblock %}
{% block script %}
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"></script>
<script>
var dom = document.getElementById("app1");
var myChart = echarts.init(dom);
var option = {
    title: {
        text: '城市降雨量折线图',
    },
    tooltip: {
        trigger: 'axis',
        axisPointer: {            // 坐标轴指示器，坐标轴触发有效
            type: 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
        }
    },
    grid: {
        left: '3%',
        right: '4%',
        bottom: '3%',
        containLabel: true
    },
    xAxis: [
        {
            type: 'category',
            data: {{count_name | safe}},
            axisTick: {
                alignWithLabel: true
            }
        }
    ],
    yAxis: [
        {
            type: 'value'
        }
    ],
    series: [
        {
            name: '降雨量',
            type: 'line',
            barWidth: '60%',
            data: {{count_AQI | safe}}
        }
    ]
};

if (option && typeof option === 'object') {
    myChart.setOption(option);
}
</script>

<script>
var dom = document.getElementById("app2");
var myChart = echarts.init(dom);
var option = {
    title: {
        text: '月度数据',
    },
    tooltip: {
        trigger: 'axis',
        axisPointer: {            // 坐标轴指示器，坐标轴触发有效
            type: 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
        }
    },
    grid: {
        left: '3%',
        right: '4%',
        bottom: '3%',
        containLabel: true
    },
    xAxis: [
        {
            type: 'category',
            data: {{zuijia_name | safe}},
            axisTick: {
                alignWithLabel: true
            }
        }
    ],
    yAxis: [
        {
            type: 'value'
        }
    ],
    series: [
        {
            name: '毫米',
            type: 'bar',
            barWidth: '60%',
            data: {{zuijia_shuju | safe}}
        }
    ]
};

if (option && typeof option === 'object') {
    myChart.setOption(option);
}
</script>

<script src="https://cdn.staticfile.org/jquery/1.10.2/jquery.min.js"></script>
{% endblock %}


